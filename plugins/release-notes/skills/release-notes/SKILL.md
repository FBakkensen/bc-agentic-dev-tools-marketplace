---
name: release-notes
description: 'Generate release notes from PR analysis. Use when drafting release notes, summarizing changes between releases, or preparing version documentation after producing .output/releases/release-analysis.jsonl.'
---

# Release Notes Generation

Generate comprehensive release notes by analyzing merged PRs since the last release.

## Prerequisites

- `.output/releases/release-analysis.jsonl` exists (generated by the analysis script).

## Step 1: Generate Analysis Data

Run the bundled script from the skill folder:

```powershell
scripts\Get-ReleaseAnalysis.ps1
```

This creates `.output/releases/release-analysis.jsonl` containing:
- **Summary record**: Release boundaries, total counts, files by category, app.json diff
- **PR records**: One per PR with description, files, commits, key AL changes, breaking change indicators

## Step 2: Initialize

1. Verify the analysis file exists:
   ```powershell
   Test-Path .output/releases/release-analysis.jsonl
   ```

2. Load the summary record (`type == "summary"`) using any JSONL-capable viewer/query tool. Keep version and compatibility info in context.

3. Build a PR list from `type == "pr"` records (number + title).

4. Create todo list with:
   - Phase todos: Initialize, Analyze PRs, Generate Notes
   - One todo per PR (description will hold analysis result)

## Step 3: Analyze PRs

Mark "Analyze PRs" phase as in-progress.

For each PR, apply the PR Classification Protocol in [references/pr-classification.md](references/pr-classification.md).

Store each result in the PR's todo description and mark completed.

### Quality Check

After all PRs analyzed, review results. Signs of insufficient analysis:
- `desc` is generic: "Updated configuration logic"
- `area` is vague: "Configuration" instead of specific page
- `details` is empty or doesn't mention UI elements
- User-facing PR marked as exclude without justification

For insufficient results, follow the Deep Dive Protocol in [references/pr-classification.md](references/pr-classification.md).

## Step 4: Generate Release Notes

Mark "Generate Notes" phase as in-progress.

1. Collect all PR results from todo descriptions
2. Group by type:
   - `feature` → New Features
   - `improvement` → Improvements
   - `bugfix` → Bug Fixes
   - `breaking` → Breaking Changes
   - `technical` → Technical Summary
   - `exclude` → Not included

3. Generate release notes using [output format](./references/output-format.md)
4. Apply [content guidelines](./references/content-guidelines.md)

## Edge Cases

| Condition | Action |
|-----------|--------|
| Zero PRs | Output "No changes in this release" with version info only |
| All PRs excluded | Version info + "This release contains only internal changes" |
| No user-facing changes | Skip User-Facing Changes section, show only Technical Summary |
| No technical changes | Skip Technical Summary section |

## Success Criteria

- Every user-facing PR has: specific area, concrete description, UI details
- Technical PRs have: category and one-line summary
- Breaking changes have: exact migration steps
- No PR is missing from the final output
- No generic descriptions like "Updated logic" or "Fixed issue"

## Output

Save final release notes to: `.output/releases/RELEASE-NOTES-[VERSION].md`

Example: For version 27.5.0 → `.output/releases/RELEASE-NOTES-27.5.0.md`

## Context Management

Each PR diff can be 500+ lines. Loading 10 PRs directly consumes 50K+ tokens, leaving insufficient context for coherent notes.

**Strategy:**
- Your context: summary record + todo list + final output
- PR analysis: one PR record at a time, produce single-line JSON
- Todo list: persistent storage for all PR analysis results
